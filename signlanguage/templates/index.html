<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>手语翻译与智能家居控制系统</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .language-switch {
            margin-left: 15px;
        }
        [lang="en"] {
            display: none;
        }
        .lang-active {
            font-weight: bold;
            text-decoration: underline;
        }
        .header {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 100px 0 70px;
            text-align: center;
            margin-bottom: 50px;
            border-radius: 0 0 20px 20px;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8 mx-auto text-center">
                    <h1 class="display-4 fw-bold mb-3">
                        <i class="fas fa-hands me-3"></i>
                        <span lang="en">Sign Language Translation and Smart Home Control System</span>
                        <span lang="zh">手语翻译与智能家居控制系统</span>
                    </h1>
                    <p class="lead mb-4">
                        <span lang="en">A modern system for sign language translation and gesture-based smart home control</span>
                        <span lang="zh">基于计算机视觉的手语翻译与手势控制智能家居系统</span>
                    </p>
                    <div class="d-flex justify-content-center">
                        <a href="#choices" class="btn btn-light btn-lg px-4 me-md-2">
                            <span lang="en">Get Started</span>
                            <span lang="zh">开始使用</span>
                            <i class="fas fa-chevron-down ms-2"></i>
                        </a>
                        <div class="language-switch ms-3 mt-2">
                            <a href="#" class="text-white lang-en" onclick="switchLanguage('en'); return false;">EN</a> /
                            <a href="#" class="text-white lang-zh lang-active" onclick="switchLanguage('zh'); return false;">中文</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <section id="choices" class="py-5">
        <div class="container">
            <h2 class="text-center mb-5">
                <i class="fas fa-hand-point-right me-2"></i>
                <span lang="en">Choose Your Experience</span>
                <span lang="zh">选择您的体验</span>
            </h2>

            <div class="row g-4">
                <div class="col-md-6">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-body text-center p-5">
                            <i class="fas fa-sign-language fa-4x mb-4 text-primary"></i>
                            <h3 class="card-title mb-3">
                                <span lang="en">Sign Language Translation</span>
                                <span lang="zh">手语翻译</span>
                            </h3>
                            <p class="card-text mb-4">
                                <span lang="en">Translate your sign language gestures to text with real-time camera recognition</span>
                                <span lang="zh">通过实时摄像头识别，将您的手语手势翻译成文字</span>
                            </p>
                            <a href="/sign_language" class="btn btn-primary btn-lg">
                                <span lang="en">Start Translating</span>
                                <span lang="zh">开始翻译</span>
                                <i class="fas fa-arrow-right ms-2"></i>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-body text-center p-5">
                            <i class="fas fa-home fa-4x mb-4 text-success"></i>
                            <h3 class="card-title mb-3">
                                <span lang="en">Smart Home Control</span>
                                <span lang="zh">智能家居控制</span>
                            </h3>
                            <p class="card-text mb-4">
                                <span lang="en">Control your smart home devices with intuitive hand gestures and movements</span>
                                <span lang="zh">通过直观的手势和动作控制您的智能家居设备</span>
                            </p>
                            <a href="/home_control" class="btn btn-success btn-lg">
                                <span lang="en">Control Home</span>
                                <span lang="zh">控制家居</span>
                                <i class="fas fa-arrow-right ms-2"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="py-5">
        <div class="container">
            <h2 class="text-center mb-5">
                <i class="fas fa-key me-2"></i>
                <span lang="en">API Configuration</span>
                <span lang="zh">API 配置</span>
            </h2>
            
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <div class="card border-0 shadow-sm">
                        <div class="card-body p-4">
                            <form id="apiKeyForm" action="/api/set_api_key" method="post">
                                <div class="mb-3">
                                    <label for="apiKey" class="form-label">
                                        <span lang="en">HKBU GenAI API Key</span>
                                        <span lang="zh">HKBU GenAI API 密钥</span>
                                    </label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="apiKey" name="apiKey" 
                                            placeholder="06fd2422-8207-4a5b-8aaa-434415ed3a2b">
                                        <button class="btn btn-primary" type="submit">
                                            <span lang="en">Save</span>
                                            <span lang="zh">保存</span>
                                        </button>
                                    </div>
                                    <div class="form-text mt-2">
                                        <span lang="en">Leave empty to use the default API key. Custom key will be stored in your browser.</span>
                                        <span lang="zh">留空将使用默认API密钥。自定义密钥将存储在您的浏览器中。</span>
                                    </div>
                                </div>
                            </form>
                            <div id="apiStatus" class="alert alert-info mt-3 d-none">
                                <span id="apiStatusText"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="py-5 bg-light">
        <div class="container">
            <h2 class="text-center mb-5">
                <i class="fas fa-star me-2"></i>
                <span lang="en">Key Features</span>
                <span lang="zh">主要功能</span>
            </h2>

            <div class="row g-4">
                <div class="col-md-4">
                    <div class="feature-item text-center">
                        <div class="feature-icon bg-primary text-white rounded-circle mb-3">
                            <i class="fas fa-camera"></i>
                        </div>
                        <h4>
                            <span lang="en">Real-time Recognition</span>
                            <span lang="zh">实时识别</span>
                        </h4>
                        <p>
                            <span lang="en">Advanced computer vision algorithms detect hand gestures instantly</span>
                            <span lang="zh">先进的计算机视觉算法即时检测手部手势</span>
                        </p>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="feature-item text-center">
                        <div class="feature-icon bg-success text-white rounded-circle mb-3">
                            <i class="fas fa-brain"></i>
                        </div>
                        <h4>
                            <span lang="en">AI-Powered</span>
                            <span lang="zh">AI 驱动</span>
                        </h4>
                        <p>
                            <span lang="en">Machine learning models understand context and improve over time</span>
                            <span lang="zh">机器学习模型理解上下文并随着时间推移而改进</span>
                        </p>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="feature-item text-center">
                        <div class="feature-icon bg-info text-white rounded-circle mb-3">
                            <i class="fas fa-magic"></i>
                        </div>
                        <h4>
                            <span lang="en">Intuitive Interface</span>
                            <span lang="zh">直观界面</span>
                        </h4>
                        <p>
                            <span lang="en">Easy-to-use design that makes gesture control feel natural</span>
                            <span lang="zh">易于使用的设计，使手势控制感觉自然</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer py-4 bg-dark text-white text-center">
        <div class="container">
            <p>
                <i class="fas fa-hands me-2"></i>
                <span lang="en">Sign Language System &copy; 2024</span>
                <span lang="zh">手语系统 &copy; 2024</span>
            </p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Language switching function
        function switchLanguage(lang) {
            // Save language preference to localStorage
            localStorage.setItem('preferredLanguage', lang);

            // Show elements of selected language and hide others
            if (lang === 'en') {
                document.querySelectorAll('[lang="en"]').forEach(el => el.style.display = 'inline');
                document.querySelectorAll('[lang="zh"]').forEach(el => el.style.display = 'none');
                document.querySelector('.lang-en').classList.add('lang-active');
                document.querySelector('.lang-zh').classList.remove('lang-active');
            } else if (lang === 'zh') {
                document.querySelectorAll('[lang="zh"]').forEach(el => el.style.display = 'inline');
                document.querySelectorAll('[lang="en"]').forEach(el => el.style.display = 'none');
                document.querySelector('.lang-zh').classList.add('lang-active');
                document.querySelector('.lang-en').classList.remove('lang-active');
            }
        }

        // Load preferred language on page load
        document.addEventListener('DOMContentLoaded', function() {
            const preferredLanguage = localStorage.getItem('preferredLanguage') || 'zh';
            switchLanguage(preferredLanguage);
            
            // 如果存在保存的API Key，显示在表单中
            const savedApiKey = localStorage.getItem('customApiKey');
            if (savedApiKey) {
                document.getElementById('apiKey').value = savedApiKey;
                showApiStatus('使用自定义API密钥', 'Using custom API key', 'success');
            }
            
            // 处理API Key表单提交
            document.getElementById('apiKeyForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const apiKeyInput = document.getElementById('apiKey');
                const apiKey = apiKeyInput.value.trim();
                
                // 发送API Key到服务器
                fetch('/api/set_api_key', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ apiKey: apiKey }),
                })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        if (apiKey) {
                            // 保存自定义API Key到本地存储
                            localStorage.setItem('customApiKey', apiKey);
                            showApiStatus('API密钥已保存并启用', 'API key saved and enabled', 'success');
                        } else {
                            // 如果输入为空，则删除自定义API Key并使用默认值
                            localStorage.removeItem('customApiKey');
                            showApiStatus('使用默认API密钥', 'Using default API key', 'info');
                        }
                    } else {
                        showApiStatus(data.message || '发生错误，请重试', data.message || 'An error occurred, please try again', 'danger');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    showApiStatus('连接错误，请重试', 'Connection error, please try again', 'danger');
                });
            });
        });
        
        // 显示API状态信息
        function showApiStatus(zhMessage, enMessage, type) {
            const statusElement = document.getElementById('apiStatus');
            const statusTextElement = document.getElementById('apiStatusText');
            const preferredLanguage = localStorage.getItem('preferredLanguage') || 'zh';
            
            statusElement.className = 'alert mt-3 alert-' + (type || 'info');
            statusTextElement.innerHTML = preferredLanguage === 'zh' ? zhMessage : enMessage;
            statusElement.classList.remove('d-none');
            
            // 5秒后自动隐藏
            setTimeout(() => {
                statusElement.classList.add('d-none');
            }, 5000);
        }
    </script>
</body>
</html>